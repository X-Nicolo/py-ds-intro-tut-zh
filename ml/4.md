# ç¬¬å››éƒ¨åˆ† ç¥ç»ç½‘ç»œ

## å››åä¸‰ã€ç¥ç»ç½‘ç»œç®€ä»‹

æ¬¢è¿é˜…è¯»æœºå™¨å­¦ä¹ ç³»åˆ—æ•™ç¨‹çš„ä¸€ä¸ªæ–°éƒ¨åˆ†ï¼šæ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œã€ä»¥åŠ TensorFlowã€‚äººé€ çš„ç¥ç»ç½‘ç»œå—ç”Ÿç‰©å­¦å¯å‘ï¼Œç”¨äºæŒ‡å¯¼æœºå™¨å­¦ä¹ ï¼Œåˆ»æ„æ¨¡æ‹Ÿä½ çš„å¤§è„‘ï¼ˆç”Ÿç‰©ç¥ç»ç½‘ç»œï¼‰ã€‚

äººé€ ç¥ç»ç½‘ç»œæ˜¯ä¸ªæ–°çš„æ¦‚å¿µï¼Œæˆ‘ç°åœ¨å°†å…¶ç”¨ç¥ç»ç½‘ç»œæ¥æŒ‡ä»£ã€‚è¿™ä¸ªæ¦‚å¿µåˆ»æ„è¿½æº¯åˆ° 20 ä¸–çºª 40 å¹´ä»£ï¼Œå¹¶ä¸”æœ‰æ•°æ¬¡æ³¢åŠ¨ï¼Œå°¤å…¶æ˜¯è·Ÿæ”¯æŒå‘é‡æœºæ¥æ¯”è¾ƒã€‚ä¾‹å¦‚ï¼Œç¥ç»ç½‘ç»œç›´åˆ° 90 å¹´ä»£ä¸­æœŸæ‰æµè¡Œï¼ŒåŒæ—¶ SVM ä½¿ç”¨ä¸€ç§æ–°å…¬å¼€çš„æŠ€æœ¯ï¼ˆæŠ€æœ¯åœ¨åº”ç”¨ä¹‹å‰ç»è¿‡äº†å¾ˆé•¿æ—¶é—´ï¼‰ï¼Œâ€œæ ¸çš„æŠ€å·§â€ï¼Œé€‚ç”¨äºéçº¿æ€§åˆ†éš”çš„æ•°æ®é›†ã€‚æœ‰äº†å®ƒï¼ŒSVM å†æ¬¡æµè¡Œèµ·æ¥ï¼Œå°†ç¥ç»ç½‘ç»œå’Œå¾ˆå¤šæœ‰è¶£çš„ä¸œè¥¿é—ç•™åœ¨äº†åé¢ï¼Œç›´åˆ° 2011 å¹´ã€‚ç”±äºå¤§é‡çš„å¯ç”¨æ•°æ®é›†ï¼Œä»¥åŠæ›´åŠ å¼ºå¤§çš„è®¡ç®—æœºï¼Œè¿™ä¸ªæ—¶å€™ç¥ç»ç½‘ç»œä½¿ç”¨æ–°çš„æŠ€å·§ï¼Œå¼€å§‹ä¼˜äº SVMã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œå¦‚æœä½ æ‰“ç®—è‡´åŠ›äºæœºå™¨å­¦ä¹ é¢†åŸŸï¼Œç†è§£å…¶å®ƒæ¨¡å‹ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºè¶‹åŠ¿å¯ä»¥æˆ–è€…çš„ç¡®æ”¹å˜äº†ã€‚æ—¢ç„¶æˆ‘ä»¬æœ‰äº†ä¸€äº›æœºå™¨ï¼Œå®ƒä»¬èƒ½å¤Ÿå®é™…æ‰§è¡Œç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæœ‰äº›æœ‰è¶£çš„æƒ…å†µï¼Œå› ä¸ºäººä»¬ä¸€ç›´åç€ï¼Œä¸€ç›´ç¢ç£¨è¿™ä¸ªè¯é¢˜å·²ç»æœ‰åå¹´äº†ã€‚è¿™å¹¶ä¸æ˜¯è¯´ï¼Œå‘è¡¨ç¥ç»ç ”ç©¶çš„è®ºæ–‡çš„äººå¾ˆå°‘è§ï¼Œå¹¶ä¸”æœ‰äº›å…·ä½“è¯é¢˜çš„è®ºæ–‡åœ¨åå¹´å‰å°±å†™å®Œäº†ã€‚

ç¥ç»ç½‘ç»œçš„æ¨¡å‹å®é™…ä¸Šæ˜¯ä¸ªéå¸¸ç®€å•çš„æ¦‚å¿µã€‚è¿™ä¸ªæ¦‚å¿µå°±æ˜¯æ¨¡æ‹Ÿç¥ç»å…ƒï¼ˆneuronï¼‰ï¼Œå¹¶ä¸”å¯¹äºä¸€ä¸ªåŸºæœ¬çš„ç¥ç»å…ƒï¼Œå®ƒæœ‰æ ‘çªï¼ˆdendritesï¼‰ã€ç»†èƒæ ¸ã€è½´çªï¼ˆaxonï¼‰å’Œè½´çªæœ«æ¢¢ï¼ˆaxon terminalï¼‰ã€‚

![](img/43-1.png)

ç„¶åï¼Œå¯¹äºä¸€ä¸ªç½‘ç»œï¼Œä½ éœ€è¦ä¸¤ä¸ªç¥ç»å…ƒã€‚ç¥ç»å…ƒé€šè¿‡æ ‘çªå’Œè½´çªæœ«æ¢¢ä¹‹é—´çš„çªè§¦ï¼ˆsynapseï¼‰æ¥ä¼ é€’ä¿¡æ¯ã€‚

![](img/43-2.png)

å¥½çš„ï¼Œæ‰€ä»¥è¿™å°±æ˜¯ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ã€‚ç°åœ¨è®¡ç®—æœºç§‘å­¦å®¶è®¤ä¸ºæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªã€‚æ‰€ä»¥æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªäººé€ ç¥ç»å…ƒçš„æ¨¡å‹ï¼š

![](img/43-3.png)

å°±æ˜¯è¿™æ ·ã€‚æ‰€ä»¥ä½ å’Œä½ çš„ç¥ç»å…ƒå¾ˆåƒäº†ã€‚è™½ç„¶ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ç®€åŒ–äº†äº‹æƒ…ï¼Œå¹¶ä¸”å¦‚æœä½ æœç´¢ç¥ç»ç½‘ç»œçš„å›¾ç‰‡ï¼Œä½ å¯èƒ½çœ‹åˆ°è¿™ä¸ªï¼š

![](img/43-4.png)

é‚£ä¸ªåœ†åœˆå°±æ˜¯ç¥ç»å…ƒæˆ–è€…èŠ‚ç‚¹ï¼Œå®ƒä»¬å¸¦æœ‰æ•°æ®ä¸Šçš„å‡½æ•°ï¼Œå¹¶ä¸”äº’ç›¸è¿æ¥çš„çº¿æ˜¯æ‰€ä¼ é€’çš„æƒé‡æˆ–è€…ä¿¡æ¯ã€‚æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªå±‚ã€‚ä½ çš„æ•°æ®çš„ç¬¬ä¸€å±‚æ˜¯è¾“å…¥å±‚ã€‚ä¹‹åï¼Œé™¤éä½ çš„è¾“å‡ºå°±æ˜¯ä½ çš„è¾“å…¥ï¼Œä½ æ‹¥æœ‰è‡³å°‘ä¸€ä¸ªéšè—å±‚ã€‚å¦‚æœä½ åªæœ‰ä¸€ä¸ªéšè—å±‚ï¼Œä½ å°±æœ‰äº†ä¸€ä¸ªå¸¸è§„çš„äººé€ ç¥ç»ç½‘ç»œã€‚å¦‚æœä½ æ‹¥æœ‰å¤šä¸ªéšè—å±‚ï¼Œä½ å°±æœ‰äº†æ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿè‡³å°‘æ˜¯æ¦‚å¿µä¸Šã€‚

æ‰€ä»¥å¯¹äºè¿™ä¸ªæ¨¡å‹ï¼Œä½ æ‹¥æœ‰è¾“å…¥æ•°æ®ï¼Œå¯¹å…¶åŠ æƒï¼Œå¹¶ä¸”å°†å…¶ä¼ ç»™ç¥ç»å…ƒä¸­çš„å‡½æ•°ã€‚ç¥ç»å…ƒä¸­çš„å‡½æ•°æ˜¯ä¸ªé˜ˆå€¼å‡½æ•°ï¼Œä¹Ÿå«ä½œæ¿€æ´»å‡½æ•°ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä½¿ç”¨ä¸€ä¸ªé«˜äºæˆ–è€…ä½äºç‰¹å®šå€¼åŠ æƒä¹‹åçš„æ€»åˆã€‚å¦‚æœå®ƒæ˜¯ï¼Œä½ å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¿¡å·ï¼ˆ1ï¼‰ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ˆ0ï¼‰ã€‚ç„¶åå®ƒåŠ æƒå¹¶ä¸”è½¬ç»™ä¸‹ä¸€ä¸ªç¥ç»å…ƒï¼Œå¹¶ä¸”æ‰§è¡ŒåŒæ ·çš„å‡½æ•°ã€‚

è¿™å°±æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹ã€‚æ‰€ä»¥ï¼Œä»€ä¹ˆæ˜¯æƒé‡å’Œé˜ˆå€¼å‡½æ•°å‘¢ï¼Ÿé¦–å…ˆï¼Œå¤šäºäº† 1974 çš„ Paul Werbosï¼Œæˆ‘ä»¬å»æ‰äº†é˜ˆå€¼â€œå˜é‡â€ã€‚æˆ‘ä»¬ä¸å°†è¿™äº›é˜ˆå€¼å¤„ç†ä¸ºå¦ä¸€ä¸ªè¦ä¼˜åŒ–çš„å˜é‡ï¼Œè€Œæ˜¯é€‰å–ç„¶åé˜ˆå€¼çš„å€¼ï¼Œå°†å…¶æƒé‡ä¸º -1ï¼Œé˜ˆå€¼æ€»æ˜¯ä¸º0,ã€‚æ— è®ºé˜ˆå€¼æœ‰å¤šå¤§ï¼Œå®ƒéƒ½ä¼šè‡ªè¡Œæ¶ˆé™¤ï¼Œå¹¶ä¸”å§‹ç»ˆä¸º 0ã€‚æˆ‘ä»¬ä»ç„¶æœ‰ä¸€ä¸ªä¸‘é™‹çš„æ­¥éª¤å‡½æ•°ï¼Œå› ä¸ºç¥ç»å…ƒäº§ç”Ÿ 0 è¿˜æ˜¯ 1 çš„å†³ç­–æ˜¯éå¸¸æ··ä¹±çš„ã€‚æˆ‘ä»¬å†³å®šä½¿ç”¨æŸç§ç±»å‹çš„ sigmoid å‡½æ•°ï¼ˆS å½¢ï¼‰æ¥ä»£æ›¿ã€‚

![](img/43-5.png)

å¯¹äºæƒé‡ï¼Œå®ƒä»¬åªæ˜¯éšæœºå¯åŠ¨ï¼Œå¹¶ä¸”å®ƒä»¬å¯¹äºæ¯ä¸ªè¾“å…¥åˆ°èŠ‚ç‚¹/ç¥ç»å…ƒæ˜¯å”¯ä¸€çš„ã€‚ ç„¶åï¼Œåœ¨å…¸å‹çš„â€œå‰é¦ˆâ€ï¼ˆæœ€åŸºæœ¬çš„ç±»å‹ï¼‰ç¥ç»ç½‘ç»œä¸­ï¼Œä½ çš„ä¿¡æ¯é€šè¿‡ä½ åˆ›å»ºçš„ç½‘ç»œç›´æ¥ä¼ é€’ï¼Œå¹¶ä½¿ç”¨ä½ çš„æ ·æœ¬æ•°æ®ï¼Œå°†è¾“å‡ºä¸æœŸæœ›è¾“å‡ºè¿›è¡Œæ¯”è¾ƒã€‚ ä»è¿™é‡Œï¼Œä½ éœ€è¦è°ƒæ•´æƒé‡ï¼Œæ¥å¸®åŠ©ä½ è·å¾—ä¸é¢„æœŸè¾“å‡ºåŒ¹é…çš„è¾“å‡ºã€‚ ç›´æ¥é€šè¿‡ç¥ç»ç½‘ç»œå‘é€æ•°æ®çš„è¡Œä¸ºç§°ä¸ºå‰é¦ˆç¥ç»ç½‘ç»œã€‚ æˆ‘ä»¬çš„æ•°æ®ä»è¾“å…¥å±‚åˆ°éšè—å±‚ï¼Œç„¶åæ˜¯è¾“å‡ºå±‚ã€‚ å½“æˆ‘ä»¬å‘åé€€ï¼Œå¼€å§‹è°ƒæ•´æƒé‡æ¥æœ€å°åŒ–æŸå¤±/æˆæœ¬æ—¶ï¼Œè¿™ç§°ä¸ºåå‘ä¼ æ’­ã€‚

è¿™æ˜¯ä¸€ä¸ªæ–°çš„ä¼˜åŒ–é—®é¢˜ã€‚ å›å¿†ä¸€ä¸‹ï¼Œå‡ ä¸ªæ•™ç¨‹ä¹‹å‰çš„æ”¯æŒå‘é‡æœºä¼˜åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å¦‚ä½•è§£é‡Šè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡¸ä¼˜åŒ–é—®é¢˜ã€‚ å³ä½¿æˆ‘ä»¬æœ‰ä¸¤ä¸ªå˜é‡ï¼Œæˆ‘ä»¬çš„ä¼˜åŒ–é—®é¢˜æ˜¯ä¸€ä¸ªå®Œç¾çš„ç¢—å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“ä»€ä¹ˆæ—¶å€™è¾¾åˆ°äº†æœ€ä¼˜åŒ–ï¼ŒåŒæ—¶æ²¿ç€è·¯å¾„æ‰§è¡Œäº†å¤§é‡çš„æ­¥éª¤ï¼Œä½¿å¤„ç†ä¾¿å®œã€‚ ä½¿ç”¨ç¥ç»ç½‘ç»œï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚ åœ¨å®é™…ä¸­ï¼Œä½ å¯»æ‰¾æ›´å¤šæˆåƒä¸Šä¸‡ä¸ªå˜é‡ï¼Œç”šè‡³æ•°ç™¾ä¸‡æˆ–æ›´å¤šçš„å˜é‡ã€‚è¿™é‡Œçš„åŸå§‹è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼Œä½†è¿˜æœ‰å…¶ä»–é€‰é¡¹ï¼Œå¦‚ AdaGrad å’Œ Adam Optimizerã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ä¸€é¡¹å·¨å¤§çš„è®¡ç®—ä»»åŠ¡ã€‚

ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œå‡ ä¹å·²ç»æç½®äº†åŠä¸ªå¤šä¸–çºªã€‚ åªæ˜¯æœ€è¿‘ï¼Œæˆ‘ä»¬æ‰æ‹¥æœ‰äº†è¿™ç§èƒ½åŠ›å’Œæ¶æ„çš„æœºå™¨ï¼Œä»¥ä¾¿æ‰§è¡Œè¿™äº›æ“ä½œï¼Œä»¥åŠç”¨äºåŒ¹é…çš„é€‚å½“å¤§å°çš„æ•°æ®é›†ã€‚ å¥½æ¶ˆæ¯æ˜¯ï¼Œæˆ‘ä»¬å·²ç»æœ‰èŠ±ä¸ªä¸–çºªæ¥å°±è¿™ä¸ªè¯é¢˜è¿›è¡Œå“²å­¦æ€è€ƒï¼Œè€Œä¸”å¤§é‡çš„åŸºç¡€å·¥ä½œå·²ç»å®Œæˆäº†ï¼Œåªéœ€è¦å®æ–½å’Œæµ‹è¯•ã€‚

æœ‰æ„æ€çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬ä¸å®Œå…¨äº†è§£äººç±»å¤§è„‘ä¸€æ ·ï¼Œæˆ‘ä»¬å¹¶ä¸å®Œå…¨ç†è§£ç¥ç»ç½‘ç»œä¸ºä»€ä¹ˆæˆ–å¦‚ä½•å®ç°è¿™æ ·æœ‰è¶£çš„ç»“æœã€‚ é€šè¿‡å¤§é‡çš„æŒ–æ˜å’Œåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ­å¼€ä¸€äº›äº‹æƒ…ï¼Œä½†æ˜¯ç”±äºè®¸å¤šå˜é‡å’Œç»´åº¦ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸å¤ªäº†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬åªæ˜¯çœ‹åˆ°äº†å¾ˆå¥½çš„ç»“æœï¼Œå¹¶ä¸”å¾ˆå¼€å¿ƒã€‚ å³ä½¿æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼ŒåŸåˆ™ä¸Šä¹Ÿæ˜¯éå¸¸åŸºæœ¬çš„ï¼Œä½†æ˜¯ä»–åšçš„äº‹æƒ…ä¹Ÿæœ‰æƒŠäººçš„ç»“æœã€‚

å¯¹äºç®€å•çš„åˆ†ç±»ä»»åŠ¡ï¼Œç¥ç»ç½‘ç»œåœ¨æ€§èƒ½ä¸Šä¸å…¶ä»–ç®€å•ç®—æ³•ç›¸å¯¹æ¥è¿‘ï¼Œç”šè‡³åƒ KNN é‚£æ ·ã€‚ ç¥ç»ç½‘ç»œä¸­çš„çœŸæ­£ç¾ä¸½å¸¦æ¥äº†æ›´å¤§çš„æ•°æ®ï¼Œæ›´å¤æ‚çš„é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªéƒ½ä½¿å…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹å˜å¾—æ— åŠ›ã€‚ ä¾‹å¦‚ï¼Œå½“å‰çš„ç¥ç»ç½‘ç»œå¯ä»¥åšå‡ºå¦‚ä¸‹å›ç­”ï¼š

> Jack 12 å²ï¼ŒJane 10 å²ï¼ŒKate æ¯” Jane å¹´é•¿ï¼Œæ¯” Jack å¹´è½»ï¼ŒKate å¤šå°‘å²ï¼Ÿ

ç­”æ¡ˆæ˜¯11ï¼Œä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹å¯ä»¥è§£é‡Šå‡ºæ¥ï¼Œæ— éœ€ä½ åœ¨æŸç§ç¨‹åº¦ä¸Šæ•™ä¼šå¦‚ä½•å®é™…å®Œæˆé€»è¾‘éƒ¨åˆ†ã€‚ ä½ åªéœ€ç®€å•åœ°ä¼ é€’åŸå§‹æ•°æ®ï¼Œå®ƒæ˜¯å•è¯ï¼Œç”šè‡³æ˜¯å­—ç¬¦ï¼Œè€Œç¥ç»ç½‘ç»œåˆ™å®Œæˆå…¶ä½™éƒ¨åˆ†ã€‚ å“¦ï¼Œä½ éœ€è¦æ•°ç™¾ä¸‡ä¸ªæ ·ä¾‹ï¼ ä»¥æ•°ç™¾ä¸‡è®¡ï¼Œæˆ‘çš„æ„æ€æ˜¯ä¸ºäº†ç†æƒ³çš„å‡†ç¡®åº¦éœ€è¦çº¦ 5 äº¿ã€‚

ä½ åœ¨å“ªé‡Œå¾—åˆ°æ•°ä»¥ç™¾ä¸‡è®¡çš„æ ·å“ï¼Ÿä½ æœ‰ä¸€äº›é€‰æ‹©ã€‚å›¾åƒæ•°æ®çš„ä¸€ä¸ªé€‰æ‹©æ˜¯ [ImageNet](https://image-net.org/)ï¼Œå®ƒåœ¨äº‹ç‰©çš„ç»„ç»‡ä¸­éå¸¸ç±»ä¼¼äº wordnetã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰ï¼Œä½ å¯ä»¥æå‡ºä¸€ä¸ªæƒ³æ³•ã€‚è¿™é‡Œçš„ä¸€åˆ‡éƒ½æ˜¯å…è´¹çš„ã€‚æ¥ä¸‹æ¥ï¼Œå¯¹äºæ–‡æœ¬æ•°æ®ï¼Œç¬¬ä¸€ä¸ªç«™ç‚¹åº”è¯¥æ˜¯åƒ[ç»´åŸºç™¾ç§‘æ•°æ®è½¬å‚¨](https://dumps.wikimedia.org/backup-index.html)ã€‚è¿™å¯¹äºæ›´å¤šçš„æ·±åº¦å­¦ä¹ çš„ä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œè€Œä¸æ˜¯æ ‡ç­¾æ•°æ®ã€‚æ¥ä¸‹æ¥ï¼Œå¯¹äºæ›´å¤šçš„æ–‡æœ¬æ•°æ®ï¼Œä¸ºä»€ä¹ˆä¸å»å·²ç»è¢«çˆ¬å»å’Œè§£æçš„å¤§éƒ¨åˆ†ç½‘ç«™å‘¢ï¼Ÿå¦‚æœè¿™å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼Œè¯·æŸ¥çœ‹ [CommonCrawl](https://commoncrawl.org/)ã€‚è¿™ä¸ªæ•°æ®é›†ä¸æ˜¯ä¸€ä¸ªç¬‘è¯ï¼Œä½†æ˜¯å®ƒçš„æ•°æ®æ˜¯ PB çº§çš„ã€‚å¯¹äºæ¼”è®²ï¼Œæˆ‘å¹¶æ²¡æœ‰å¾ˆå¤šæ€è·¯ã€‚ä¸€ä¸ªé€‰é¡¹æ˜¯åƒ [Tatoeba](https://tatoeba.org/eng/)ï¼Œå®ƒæœ‰æ ‡ç­¾å’Œä¸€äº›ç¿»è¯‘ï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚å½“ä¸€åˆ‡éƒ½å¤±è´¥æ—¶ï¼Œä½ å¯ä»¥å°è¯•åˆ›å»ºè‡ªå·±çš„æ•°æ®é›†ï¼Œä½†æ˜¯å¤§å°è¦æ±‚ç›¸å½“æœ‰æŒ‘æˆ˜æ€§ã€‚å¦å¤–ï¼Œä½ å¯ä»¥éšæ—¶å¯»æ±‚å¸®åŠ©ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼Œå­˜åœ¨ä»»ä½•ä¸œè¥¿çš„æ•°æ®é›†ï¼Œä½ åªéœ€è¦æ‰¾åˆ°å®ƒã€‚å¾ˆå¤šæ—¶å€™ï¼ŒGoogle åœ¨å°è¯•æŸ¥æ‰¾æ•°æ®é›†æ—¶ä¼šå¤±è´¥ï¼Œä½†æ˜¯äººä»¬å¯ä»¥å¸®åŠ©ä½ ã€‚ç›®å‰ï¼Œä½ å¯ä»¥åœ¨[æœºå™¨å­¦ä¹  subreddit](https://www.reddit.com/r/machinelearning/) ä¸­å°è¯•è¯¢é—®ï¼Œå¤§æ¦‚ 90% çš„å†…å®¹ä¸ç¥ç»ç½‘ç»œç›¸å…³ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦äº†è§£å¤§é‡çš„æ•°æ®é›†ã€‚

ç°åœ¨åº”è¯¥æ¯”è¾ƒæ˜æ˜¾çš„æ˜¯ï¼Œåƒ Facebook å’Œ Google è¿™æ ·çš„å…¬å¸ï¼Œå¯¹äº AI å’Œç¥ç»ç½‘ç»œçš„æŠ•å…¥å¦‚æ­¤ä¹‹å¤§ã€‚ ä»–ä»¬å®é™…ä¸Šæ‹¥æœ‰æ‰€éœ€çš„æ•°æ®é‡æ¥åšä¸€äº›éå¸¸æœ‰è¶£çš„äº‹æƒ…ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰è¿™æ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨ç¥ç»ç½‘ç»œä¸Šå·¥ä½œï¼Ÿ æˆ‘ä»¬å°†ä½¿ç”¨ TensorFlowï¼Œè¿™æ˜¯ Google çš„ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„è½¯ä»¶åŒ…ï¼Œåœ¨æ’°å†™æœ¬æ–‡æ—¶ä»ç„¶æ˜¯æµ‹è¯•ç‰ˆã€‚ è¿˜æœ‰å…¶ä»–ç”¨äºæœºå™¨å­¦ä¹ çš„åŒ…ï¼Œå¦‚ Theano æˆ– Torchï¼Œä½†å®ƒä»¬éƒ½ä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œã€‚ æˆ‘ä»¬çœŸçš„åªéœ€è¦é€‰ä¸€ä¸ªï¼Œæˆ‘é€‰æ‹© Tensorflowã€‚ åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å®‰è£… TensorFlowã€‚ å¦‚æœä½ å·²ç»å®‰è£…äº† TensorFlowï¼Œå¯ä»¥è·³è¿‡ä¸‹ä¸€ä¸ªæ•™ç¨‹ï¼ˆä½¿ç”¨ä¾§é¢å¯¼èˆªæ ï¼Œæˆ–è€…å•å‡»ä¸‹ä¸€æ­¥ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨ï¼Œç„¶åå†æ¬¡å•å‡»ï¼‰ã€‚


## å››åå››ã€ä¸ºç¥ç»ç½‘ç»œå®‰è£… TensorFlowï¼ˆå¯é€‰ï¼‰

> åŸæ–‡ï¼š[Installing TensorFlow for Deep Learning - OPTIONAL
](https://pythonprogramming.net/installing-tensorflow-machine-learning-tutorial/)

è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„æ•™ç¨‹ï¼Œç”¨äºå®‰è£… TensorFlowã€‚ å¦‚æœä½ æœ‰ Mac æˆ–è€… Linuxï¼Œä½ ä¸éœ€è¦è¿™ä¸ªæ•™ç¨‹ï¼Œåªéœ€è®¿é—®`TensorFlow.org > get started > pip installation`ã€‚ ä½ åªéœ€è¦è¿è¡Œå‡ ä¸ªå‘½ä»¤ï¼Œç„¶åå°±è®¾ç½®å¥½äº†ã€‚ å¯¹äº Windows ç”¨æˆ·ï¼Œä½ éœ€è¦ä½¿ç”¨ Docker æˆ–è™šæ‹Ÿæœºæ¥å®‰è£… TensorFlowã€‚ æˆ‘é€‰æ‹©è™šæ‹Ÿæœºï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ï¼Œåæ¥å¯èƒ½éœ€è¦ä½¿ç”¨åŒå¼•å¯¼ã€‚

å¯¹äºå¯åŠ¨ï¼ŒTensorFlow ç”± Mac å’Œ Linux æ”¯æŒï¼Œä½† Windows ä¸æ”¯æŒã€‚ å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨ Windows ä¸Šä½¿ç”¨å®ƒä»¬çš„ Docker å‘è¡ŒåŒ…ã€‚

ä½ å¯ä»¥éšæ„ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„è®¾ç½®ï¼Œä½†æˆ‘ä¸ªäººå°†åœ¨ Windows æœºå™¨ä¸Šçš„è™šæ‹Ÿæœºä¸Šä½¿ç”¨ Ubuntu 16.04ã€‚ ç›®å‰ï¼Œäººä»¬è¦åœ¨å“ªä¸ªå¹³å°æ‰§è¡Œæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè¿˜æ˜¯æ¯”è¾ƒä¸æ¸…æ¥šçš„ï¼Œæ‰€ä»¥è°ä¹Ÿä¸çŸ¥é“å“ªä¸ªæ“ä½œç³»æ•°æœ€ç»ˆä¼šæˆä¸ºè¿™ä¸ªé¢†åŸŸçš„ç‹è€…ã€‚ éšæ„ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦ä½¿ç”¨çš„æ–¹æ³•ï¼Œè¿™ä¸€ç‚¹ä¸é‡è¦ï¼Œä½†æˆ‘ä»ç„¶ç®€å•é€šè¿‡è™šæ‹Ÿæœºæ¥è¿è¡Œã€‚

é¦–å…ˆï¼Œä¸‹è½½ [Virtualbox](https://www.virtualbox.org/wiki/Downloads)ã€‚ è¿™å°†å…è®¸ä½ è™šæ‹ŸåŒ–å„ç§ç»„ä»¶ï¼Œå¦‚ä¸€äº› CPUï¼ŒGPU å’Œç£ç›˜ç©ºé—´ã€‚ æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦ä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚ æˆ‘é€‰æ‹© [Ubuntu 16.04 64bit](https://www.ubuntu.com/download/alternative-downloads)ã€‚ å¦‚æœä½ æœ‰ 64 ä½å¤„ç†å™¨ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿è¡Œ 64 ä½çš„æ˜ åƒï¼Œä½†æ˜¯ä½ å¯èƒ½éœ€è¦åœ¨ BIOS è®¾ç½®ä¸­å¯ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ–ï¼Œè¿™åœ¨ BIOS è®¾ç½®çš„ CPU éƒ¨åˆ†æ˜¾ç¤ºã€‚ æ¯ä¸ªä¸»æ¿æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½æ›´å…·ä½“äº†ã€‚ åªéœ€åœ¨è®¾ç½®å’Œé«˜çº§è®¾ç½®ä¸­æŸ¥æ‰¾ CPU è®¾ç½®é€‰é¡¹ã€‚

ä¸€æ—¦ä½ å®‰è£…äº† VirtualBox è½¯ä»¶ï¼Œä»¥åŠè¦ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜ åƒï¼Œè¯·åœ¨ VirtualBox ä¸­å•å‡»â€œæ–°å»ºâ€ï¼Œä¸ºæ–°æœºå™¨å‘½åï¼Œé€‰æ‹©æ“ä½œç³»ç»Ÿçš„ç±»å‹å’Œç‰ˆæœ¬ï¼Œç„¶åè½¬åˆ°ä¸‹ä¸€ä¸ªé€‰é¡¹ã€‚

å¦‚æœä½ æƒ³çœ‹åˆ°æˆ‘çš„å®æ—¶é€‰é¡¹ï¼Œä½ å¯ä»¥è§‚çœ‹è§†é¢‘ã€‚ ç„¶è€Œï¼Œè®¾ç½®éå¸¸ç®€å•ã€‚ é€‰æ‹©ä¸€ä¸ªå›ºå®šå¤§å°çš„ç¡¬ç›˜ï¼Œè‡³å°‘è¦æœ‰ 20 GB çš„ç¡¬ç›˜ã€‚ æˆ‘é€‰æ‹©äº† 50.VDIã€‚ é€‰æ‹©é€‚é…å†…å­˜çš„ä¸œè¥¿ã€‚ ä½ ä»ç„¶éœ€è¦ä¸€äº›å†…å­˜ç•™ç»™ä½ çš„ä¸»æœºï¼Œæ‰€ä»¥ä¸è¦å…¨éƒ¨éƒ½å äº†ã€‚

ä¸€æ—¦ä½ å®Œæˆäº†ï¼Œä½ å¯ä»¥åŒå‡»è™šæ‹Ÿæœºæ¥å°è¯•å¯åŠ¨å®ƒï¼Œä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªæ¶ˆæ¯ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥å¼•å¯¼ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¯åŠ¨é©±åŠ¨å™¨ã€‚ ä»è¿™é‡Œå¯ä»¥é€‰æ‹©ä½ æœ€è¿‘ä¸‹è½½çš„ Ubuntu å®‰è£…æ˜ åƒï¼Œå¹¶å¼€å§‹å®‰è£…è¿‡ç¨‹ã€‚ å®‰è£…æ—¶ï¼Œä½ å°†äº†è§£åˆ°æ˜¯å¦è¦æ“¦é™¤ç¡¬ç›˜é©±åŠ¨å™¨çš„å†…å®¹ï¼Œå¹¶æ›¿æ¢ä¸º Ubuntuã€‚ å¯èƒ½æ„Ÿè§‰ä¸èˆ’æœï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£å°±æ˜¯ä½ æƒ³åšçš„ã€‚ è¿™å°†æ¸…é™¤è™šæ‹Ÿç¡¬ç›˜ä¸Šçš„å®‰è£…ï¼Œè€Œä¸æ˜¯å®é™…çš„ç¡¬ç›˜é©±åŠ¨å™¨ã€‚

å®‰è£…å®Œæˆåï¼Œç³»ç»Ÿå°†æç¤ºä½ é‡å¯è™šæ‹Ÿæœºã€‚ é‡æ–°å¯åŠ¨æç¤ºä¼¼ä¹å¯¹æˆ‘æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥å…³é—­çª—å£æ¥å…³é—­ç”µæºï¼Œæˆ–è€…ä» GUI å³é”®å•å‡»ä½ çš„è™šæ‹Ÿæœºï¼Œå¹¶é€‰æ‹©å…³é—­ã€‚

å½“ä½ å…³é—­è™šæ‹Ÿæœºæ—¶ï¼Œä½ å¯ä»¥å³é”®å•å‡»å®ƒï¼Œç„¶åè¿›å…¥è®¾ç½®ã€‚ åœ¨é‚£é‡Œï¼Œè¿›å…¥ç³»ç»Ÿï¼Œå¹¶åˆ†é…å¤šäº cpus(1) çš„é»˜è®¤æ•°é‡ã€‚ è¿™äº›åªä¼šåœ¨å¯åŠ¨æ—¶åˆ†é…ç»™ä½ çš„è™šæ‹Ÿæœºï¼Œè€Œä¸æ˜¯æ‰€æœ‰æ—¶é—´ã€‚ ä½ å¯èƒ½è¿˜æƒ³ä¸ºè§†é¢‘ï¼Œç»™è‡ªå·±ä¸€äº›æ›´å¤šçš„å†…å­˜ã€‚

ç°åœ¨å¼€æœºï¼Œä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ä½ æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹æ“ä½œæ¥å¯ç”¨å¯è°ƒæ•´å¤§å°çš„å±å¹•ï¼š

```
sudo apt-get install virtualbox-guest-utils virtualbox-guest-x11 virtualbox-guest-dkms
```

ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½åœ¨æˆ‘ä»¬çš„æœºå™¨ä¸Šå®‰è£… TensorFlowã€‚ ä½ è¿˜éœ€è¦ Python3ï¼Œä½†è¿™æ˜¯ Ubuntu 16.04 è‡ªå¸¦çš„ã€‚ å‰å¾€ TensorFlow.orgï¼Œç‚¹å‡»å¼€å§‹ï¼Œç„¶ååœ¨ä¾§æ ä¸Šçš„`pip installation`ã€‚ å¦‚æœä½ ç¨åæŸ¥çœ‹æœ¬æ•™ç¨‹ï¼Œå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ ä½†æ˜¯ï¼Œéšç€äº‹æƒ…çš„å˜åŒ–ï¼Œæˆ‘ä¼šå°½åŠ›æ›´æ–°è¿™ä¸ªæ–‡æœ¬çš„ç‰ˆæœ¬ã€‚ æ‰€ä»¥ï¼Œåœ¨`pip installation`é¡µé¢ä¸Šï¼ŒæŒ‡å—é¦–å…ˆè®©æˆ‘ä»¬è¿è¡Œï¼š


```
$ sudo apt-get install python3-pip python3-dev
```

ä»¥ä¸Šåœ¨ä½ çš„ç»ˆç«¯ä¸­è¿è¡Œã€‚ åœ¨ Ubuntu ä¸Šï¼Œä½ å¯ä»¥æŒ‰`ctrl + alt + t`ä½¿å…¶åœ¨ GUI æ¡Œé¢ä¸Šå‡ºç°ã€‚ ç”±äºæˆ‘è¿è¡Œçš„æ˜¯ 64 ä½ç‰ˆæœ¬çš„ Linuxï¼ˆUbuntuï¼‰ï¼Œæœ‰äº† Python 3.5ï¼Œè€Œä¸”æƒ³è¦ CPU ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©ï¼š

```
# Ubuntu/Linux 64-bit, CPU only, Python 3.5
$ export TF_BINARY_URL=https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.9.0-cp35-cp35m-linux_x86_64.whl
```

ä¹‹åæ‰§è¡Œï¼š

```
$ sudo pip3 install --upgrade $TF_BINARY_URL
```

æˆ‘ä»¬å®Œæˆäº†ã€‚ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­è¾“å…¥`python3`ï¼Œå¹¶å°è¯•å¯¼å…¥`tensorflow`ã€‚ å¦‚æœå·¥ä½œæ­£å¸¸ï¼Œæˆ‘ä»¬å°±éƒ½è®¾ç½®å¥½äº†ï¼

æˆ‘ä½¿ç”¨ Sublime Text æ¥ç¼–è¾‘ Python æ–‡ä»¶ã€‚ ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„ ç¼–è¾‘å™¨ã€‚åœ¨ Ubuntu ä¸Šï¼Œä¸€æ—¦ä¸‹è½½äº†`.deb`æ–‡ä»¶ï¼Œä½ éœ€è¦è¿è¡Œï¼š`sudo dpkg -i /path/to/deb/file`ï¼Œç„¶å`sudo apt-get install -f`ã€‚

ä¸‹ä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ‰“ç®—æ¶‰åŠä½¿ç”¨ TensorFlow çš„åŸºç¡€ã€‚


## å››åäº”ã€æ·±åº¦å­¦ä¹ å’Œ TensorFlow ç®€ä»‹

æ¬¢è¿é˜…è¯»æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œå’Œ TensorFlow çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œä»¥åŠæœºå™¨å­¦ä¹ æ•™ç¨‹ç³»åˆ—çš„ç¬¬ 44 éƒ¨åˆ†ã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›å…³äº TensorFlow çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠå¦‚ä½•å¼€å§‹ä½¿ç”¨å®ƒã€‚

åƒ TensorFlow å’Œ Theano è¿™æ ·çš„åº“ä¸ä»…ä»…æ˜¯æ·±å…¥å­¦ä¹ åº“ï¼Œå®ƒä»¬æ˜¯**ç”¨äº**æ·±å…¥å­¦ä¹ çš„åº“ã€‚ ä»–ä»¬å®é™…ä¸Šåªæ˜¯æ•°å€¼å¤„ç†åº“ï¼Œå°±åƒ Numpy ä¸€æ ·ã€‚ ç„¶è€Œï¼Œä¸åŒçš„æ˜¯ï¼Œåƒ TensorFlow è¿™æ ·çš„è½¯ä»¶åŒ…ä½¿æˆ‘ä»¬èƒ½å¤Ÿä»¥é«˜æ•ˆç‡æ‰§è¡Œç‰¹å®šçš„æœºå™¨å­¦ä¹ æ•°å€¼å¤„ç†æ“ä½œï¼Œå¦‚å·¨å¤§çš„çŸ©é˜µä¸Šçš„æ±‚å¯¼ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥è½»æ¾åœ°åœ¨ CPU å†…æ ¸ï¼ŒGPU å†…æ ¸æˆ–ç”šè‡³å¤šä¸ª GPU ç­‰å¤šä¸ªè®¾å¤‡ä¸Šåˆ†å¸ƒå¼å¤„ç†ã€‚ ä½†è¿™ä¸æ˜¯å…¨éƒ¨ï¼ æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨å…·æœ‰ TensorFlow çš„åˆ†å¸ƒå¼è®¡ç®—æœºç½‘ç»œä¸Šåˆ†å‘è®¡ç®—ã€‚ æ‰€ä»¥ï¼Œè™½ç„¶ TensorFlow ä¸»è¦æ˜¯ä¸æœºå™¨å­¦ä¹ ä¸€èµ·ä½¿ç”¨ï¼Œä½†å®ƒå®é™…ä¸Šåœ¨å…¶ä»–é¢†åŸŸä¹Ÿæœ‰ä½¿ç”¨ï¼Œå› ä¸ºå®ƒçœŸçš„åªæ˜¯ä¸€ä¸ªåºå¤§çš„æ•°ç»„æ“ä½œåº“ã€‚

ä»€ä¹ˆæ˜¯å¼ é‡ï¼ˆtensorï¼‰ï¼Ÿ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æœºå™¨å­¦ä¹ ç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨å‘é‡ï¼ˆnumpy æ•°ç»„ï¼‰ï¼Œå¼ é‡å¯ä»¥æ˜¯ä¸€ä¸ªå‘é‡ã€‚ æœ€ç®€å•çš„è¯´ï¼Œä¸€ä¸ªå¼ é‡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œä¸€ä¸ªæ•°ç»„å¯ä»¥å®¹çº³ä½ çš„çŸ©é˜µï¼Œä½ çš„å‘é‡ï¼Œç”šè‡³ä¸€ä¸ªæ ‡é‡ã€‚

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦å°†æœºå™¨å­¦ä¹ é—®é¢˜è½¬åŒ–ä¸ºå¼ é‡å‡½æ•°ï¼Œè¿™å¯ä»¥ç”¨æ¯ä¸€ä¸ª ML ç®—æ³•æ¥å®ç°ã€‚ è€ƒè™‘ç¥ç»ç½‘ç»œã€‚ ç¥ç»ç½‘ç»œèƒ½å¤Ÿåˆ†è§£æˆä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬æœ‰æ•°æ®ï¼ˆ`X`ï¼‰ï¼Œæƒé‡ï¼ˆ`w`ï¼‰å’Œé˜ˆå€¼ï¼ˆ`t`ï¼‰ã€‚ æ‰€æœ‰è¿™äº›éƒ½æ˜¯å¼ é‡å˜›ï¼Ÿ `X`æ˜¯æ•°æ®é›†ï¼ˆä¸€ä¸ªæ•°ç»„ï¼‰ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¼ é‡ã€‚ æƒé‡ä¹Ÿæ˜¯ä¸€ç»„æƒé‡å€¼ï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿæ˜¯å¼ é‡ã€‚é˜ˆå€¼ï¼Ÿ ä¸æƒé‡ç›¸åŒã€‚ å› æ­¤ï¼Œæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œç¡®å®æ˜¯`X`ï¼Œ`w`å’Œ``tæˆ–`f(Xwt)`çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡†å¤‡å®Œå…¨äº†ï¼Œå½“ç„¶å¯ä»¥ä½¿ç”¨ TensorFlowï¼Œä½†æ˜¯å¦‚ä½•å‘¢ï¼Ÿ

TensorFlow çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œé¦–å…ˆå®šä¹‰å’Œæè¿°æˆ‘ä»¬çš„æŠ½è±¡æ¨¡å‹ï¼Œç„¶ååœ¨æˆ‘ä»¬å‡†å¤‡å¥½çš„æ—¶å€™ï¼Œåœ¨ä¼šè¯ï¼ˆsessionï¼‰ä¸­æˆä¸ºç°å®ã€‚ åœ¨ TensorFlow æœ¯è¯­ä¸­ï¼Œè¯¥æ¨¡å‹çš„æè¿°æ˜¯æ‰€è°“çš„â€œè®¡ç®—å›¾å½¢â€ã€‚ æˆ‘ä»¬æ¥ç©ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ„å»ºå›¾ï¼š

```py
import tensorflow as tf

# creates nodes in a graph
# "construction phase"
x1 = tf.constant(5)
x2 = tf.constant(6)
```

æ‰€ä»¥æˆ‘ä»¬æœ‰äº†ä¸€äº›å€¼ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›å€¼åšä¸€äº›äº‹æƒ…ï¼Œä¾‹å¦‚ç›¸ä¹˜ï¼š

```py
result = tf.mul(x1,x2)
print(result)
```

è¦æ³¨æ„è¾“å‡ºä»ç„¶æ˜¯ä¸ªæŠ½è±¡çš„å¼ é‡ã€‚æ²¡æœ‰è¿è¡Œå®é™…è®¡ç®—ï¼Œåªèƒ½åˆ›å»ºæ“ä½œã€‚æˆ‘ä»¬çš„è®¡ç®—å›¾ä¸­çš„æ¯ä¸ªæ“ä½œæˆ–â€œopâ€éƒ½æ˜¯å›¾ä¸­çš„â€œèŠ‚ç‚¹â€ã€‚

è¦çœŸæ­£çœ‹åˆ°ç»“æœï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œä¼šè¯ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œä½ é¦–å…ˆæ„å»ºå›¾å½¢ï¼Œç„¶åâ€œå¯åŠ¨â€å›¾å½¢ï¼š

```py
# defines our session and launches graph
sess = tf.Session()
# runs result
print(sess.run(result))
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¼šè¯çš„è¾“å‡ºèµ‹ç»™å˜é‡ï¼š

```py
output = sess.run(result)
print(output)
```

å½“ä½ å®Œæˆäº†ä¸€ä¸ªä¼šè¯æ˜¯ï¼Œä½ éœ€è¦å…³é—­å®ƒï¼Œæ¥é‡Šæ”¾æ‰€ä½¿ç”¨çš„èµ„æºã€‚

```py
sess.close()
```

å…³é—­ä¹‹åï¼Œä½ ä»ç„¶å¯ä»¥å¼•ç”¨`output`å˜é‡ï¼Œä½†æ˜¯ä½ ä¸èƒ½è¿™æ ·åšäº†ï¼š

```py
sess.run(result)
```

è¿™ä¼šè¿”å›é”™è¯¯å¦ä¸€ä¸ªé€‰é¡¹å°±æ˜¯åˆ©ç”¨ Python çš„`with`è¯­å¥ï¼š

```py
with tf.Session() as sess:
    output = sess.run(result)
    print(output)
```

å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™äº›æ“ä½œï¼Œå®ƒåœ¨è¿™äº›è¯­å¥æ‰€åœ¨çš„ä»£ç å—ä¸­ä½¿ç”¨ä¼šè¯ï¼Œç„¶ååœ¨å®Œæˆåè‡ªåŠ¨å…³é—­ä¼šè¯ï¼Œå’Œä½¿ç”¨`with`è¯­å¥æ‰“å¼€æ–‡ä»¶çš„æ–¹æ³•ç›¸åŒã€‚

ä½ è¿˜å¯ä»¥åœ¨å¤šä¸ªè®¾å¤‡ä¸Šä½¿ç”¨ TensorFlowï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨å¤šå°åˆ†å¸ƒå¼æœºå™¨ã€‚ åœ¨ç‰¹å®š GPU ä¸Šè¿è¡ŒæŸäº›è®¡ç®—çš„ç¤ºä¾‹æ˜¯ï¼š

```py
with tf.Session() as sess:
  with tf.device("/gpu:1"):
    matrix1 = tf.constant([[3., 3.]])
    matrix2 = tf.constant([[2.],[2.]])
    product = tf.matmul(matrix1, matrix2)
```

ä»£ç æ¥è‡ªï¼š[TensorFlow æ–‡æ¡£](https://www.tensorflow.org/versions/r0.9/get_started/basic_usage.html#overview)ã€‚`tf.matmul`æ˜¯çŸ©é˜µä¹˜æ³•å‡½æ•°ã€‚

ä¸Šè¿°ä»£ç å°†åœ¨ç¬¬äºŒä¸ªç³»ç»Ÿ GPU ä¸Šè¿è¡Œè®¡ç®—ã€‚ å¦‚æœä½ å®‰è£…äº† CPU ç‰ˆæœ¬ï¼Œé‚£ä¹ˆè¿™ä¸æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œä½†æ˜¯ä½ ä»ç„¶åº”è¯¥æ„è¯†åˆ°è¿™ä¸ªå¯èƒ½æ€§ã€‚ TensorFlow çš„ GPU ç‰ˆæœ¬è¦æ±‚æ­£ç¡®è®¾ç½® CUDAï¼ˆä»¥åŠéœ€è¦æ”¯æŒ CUDA çš„ GPUï¼‰ã€‚ æˆ‘æœ‰å‡ ä¸ªæ”¯æŒ CUDA çš„ GPUï¼Œå¹¶å¸Œæœ›æœ€ç»ˆèƒ½å¤Ÿå……åˆ†ä½¿ç”¨å®ƒä»¬ï¼Œä½†è¿™è¦ç­‰åˆ°ä»¥åäº†ï¼

ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº† TensorFlow çš„åŸºç¡€çŸ¥è¯†äº†ï¼Œä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­æˆ‘ä¼šé‚€è¯·ä½ ï¼Œåˆ›å»ºä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œçš„â€œå…”å­æ´â€ã€‚ å¦‚æœä½ éœ€è¦å®‰è£… TensorFlowï¼Œå¦‚æœä½ åœ¨ Mac æˆ– Linux ä¸Šï¼Œå®‰è£…è¿‡ç¨‹éå¸¸ç®€å•ã€‚ åœ¨ Windows ä¸Šï¼Œä¹Ÿä¸æ˜¯å¾ˆéº»çƒ¦ã€‚ ä¸‹ä¸€ä¸ªæ•™ç¨‹æ˜¯å¯é€‰çš„ï¼Œå®ƒåªæ˜¯ç”¨äºåœ¨ Windows æœºå™¨ä¸Šå®‰è£… TensorFlowã€‚


## å››åå…­ã€æ·±åº¦å­¦ä¹ å’Œ TensorFlow - åˆ›å»ºç¥ç»ç½‘ç»œæ¨¡å‹

æ¬¢è¿é˜…è¯»æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œå’Œ TensorFlow çš„ç¬¬ä¸‰éƒ¨åˆ†ï¼Œä»¥åŠæœºå™¨å­¦ä¹ æ•™ç¨‹ç³»åˆ—çš„ç¬¬ 45 éƒ¨åˆ†ã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆTensorFlowï¼‰ï¼Œæ¥è¿›å…¥ï¼ˆä¸‹è½ï¼‰çš„å…”å­æ´ã€‚

æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ MNIST æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†åŒ…å« 6 ä¸‡ä¸ªæ‰‹å†™å’Œæ ‡è®°æ•°å­—è®­ç»ƒæ ·æœ¬å’Œ 10,000 ä¸ªçš„æµ‹è¯•æ ·æœ¬ï¼Œ0 åˆ° 9ï¼Œå› æ­¤å…±æœ‰ 10 ä¸ªâ€œåˆ†ç±»â€ã€‚ æˆ‘ä¼šæ³¨æ„åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å°çš„æ•°æ®é›†ï¼Œå°±ä½ åœ¨ä»»ä½•ç°å®ç¯å¢ƒä¸­çš„å·¥ä½œè€Œè¨€ï¼Œå®ƒä¹Ÿåº”è¯¥è¶³å¤Ÿå°åˆ°åœ¨æ¯ä¸ªäººçš„ç”µè„‘ä¸Šå·¥ä½œã€‚

MNIST æ•°æ®é›†å…·æœ‰å›¾åƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çº¯ç²¹çš„é»‘è‰²å’Œç™½è‰²ï¼Œé˜ˆå€¼ï¼Œå›¾åƒï¼Œæ€»å…± 28Ã—28 æˆ– 784 åƒç´ ã€‚ æˆ‘ä»¬çš„ç‰¹å¾æ˜¯æ¯ä¸ªåƒç´ çš„åƒç´ å€¼ï¼Œé˜ˆå€¼ã€‚ åƒç´ æ˜¯â€œç©ºç™½â€ï¼ˆæ²¡æœ‰ä»€ä¹ˆï¼Œ0ï¼‰ï¼Œæˆ–æœ‰ä¸œè¥¿ï¼ˆ1ï¼‰ã€‚ è¿™äº›æ˜¯æˆ‘ä»¬çš„ç‰¹å¾ã€‚ æˆ‘ä»¬å°è¯•ä½¿ç”¨è¿™ä¸ªéå¸¸åŸºæœ¬çš„æ•°æ®ï¼Œå¹¶é¢„æµ‹æˆ‘ä»¬æ­£åœ¨æŸ¥çœ‹çš„æ•°å­—ï¼ˆ0 ~ 9ï¼‰ã€‚ æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œï¼Œå°†ä»¥æŸç§æ–¹å¼åˆ›å»ºåƒç´ ä¹‹é—´çš„å…³ç³»çš„å†…åœ¨æ¨¡å‹ï¼Œå¹¶ä¸”èƒ½å¤ŸæŸ¥çœ‹æ•°å­—çš„æ–°æ ·ä¾‹ï¼Œå¹¶ä¸”é«˜å‡†ç¡®åº¦é¢„æµ‹ã€‚

è™½ç„¶è¿™é‡Œçš„ä»£ç ä¸ä¼šé‚£ä¹ˆé•¿ï¼Œä½†å¦‚æœä½ ä¸å®Œå…¨äº†è§£åº”è¯¥å‘ç”Ÿçš„äº‹æƒ…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•å‡ç»“æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢æ‰€å­¦åˆ°çš„çŸ¥è¯†ï¼Œä»¥åŠæˆ‘ä»¬åœ¨è¿™é‡Œä¼šåšä»€ä¹ˆã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ä¼ å…¥è¾“å…¥æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ°éšè—å±‚1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥æ•°æ®åŠ æƒï¼Œå¹¶å°†å…¶å‘é€åˆ°å±‚1ã€‚åœ¨é‚£é‡Œå°†ç»å†æ¿€æ´»å‡½æ•°ï¼Œå› æ­¤ç¥ç»å…ƒå¯ä»¥å†³å®šæ˜¯å¦è§¦å‘ï¼Œå¹¶å°†ä¸€äº›æ•°æ®è¾“å‡ºåˆ°è¾“å‡ºå±‚æˆ–å¦ä¸€ä¸ªéšè—å±‚ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªéšè—å±‚ï¼Œä½¿ä¹‹æˆä¸ºæ·±åº¦ç¥ç»ç½‘ç»œã€‚ä»æˆ‘ä»¬å¾—åˆ°çš„è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å°†è¯¥è¾“å‡ºä¸é¢„æœŸè¾“å‡ºè¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬ä½¿ç”¨æˆæœ¬å‡½æ•°ï¼ˆæˆ–ç§°ä¸ºæŸå¤±å‡½æ•°ï¼‰æ¥ç¡®å®šæˆ‘ä»¬çš„æ­£ç¡®ç‡ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¼˜åŒ–å™¨å‡½æ•°ï¼ŒAdam Optimizerã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å°åŒ–æŸå¤±ï¼ˆæˆ‘ä»¬æœ‰å¤šé”™è¯¯ï¼‰ã€‚æˆæœ¬æœ€å°åŒ–çš„æ–¹æ³•æ˜¯é€šè¿‡ä¿®æ”¹æƒé‡ï¼Œç›®çš„æ˜¯å¸Œæœ›é™ä½æŸå¤±ã€‚æˆ‘ä»¬è¦é™ä½æŸå¤±çš„é€Ÿåº¦ç”±å­¦ä¹ ç‡å†³å®šã€‚å­¦ä¹ ç‡è¶Šä½ï¼Œæˆ‘ä»¬å­¦ä¹ çš„é€Ÿåº¦è¶Šæ…¢ï¼Œæˆ‘ä»¬è¶Šæœ‰å¯èƒ½è·å¾—æ›´å¥½çš„ç»“æœã€‚å­¦ä¹ ç‡è¶Šé«˜ï¼Œæˆ‘ä»¬å­¦ä¹ è¶Šå¿«ï¼Œè®­ç»ƒæ—¶é—´æ›´çŸ­ï¼Œä¹Ÿå¯èƒ½ä¼šå—åˆ°å½±å“ã€‚å½“ç„¶ï¼Œè¿™é‡Œçš„æ”¶ç›Šé€’å‡ï¼Œä½ ä¸èƒ½åªæ˜¯ç»§ç»­é™ä½å­¦ä¹ ç‡ï¼Œå¹¶ä¸”æ€»æ˜¯åšå¾—æ›´å¥½ã€‚

é€šè¿‡æˆ‘ä»¬çš„ç½‘ç»œç›´æ¥å‘é€æ•°æ®çš„è¡Œä¸ºï¼Œæ„å‘³ç€æˆ‘ä»¬æ­£åœ¨è¿è¡Œå‰é¦ˆç¥ç»ç½‘ç»œã€‚ å‘åè°ƒæ•´æƒé‡æ˜¯æˆ‘ä»¬çš„åå‘ä¼ æ’­ã€‚

æˆ‘ä»¬è¿™æ ·åšæ˜¯å‘å‰å’Œå‘åä¼ æ’­ï¼Œä½†æˆ‘ä»¬æƒ³è¦å¤šæ¬¡ã€‚ è¿™ä¸ªå‘¨æœŸè¢«ç§°ä¸ºä¸€ä¸ªè¿­ä»£ï¼ˆepochï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»»ä½•æ•°é‡çš„è¿­ä»£ï¼Œä½†ä½ å¯èƒ½æƒ³è¦é¿å…å¤ªå¤šï¼Œè¿™ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚

åœ¨æ¯ä¸ªæ—¶ä»£ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›è¿›ä¸€æ­¥è°ƒæ•´æˆ‘ä»¬çš„æƒé‡ï¼Œé™ä½æŸå¤±å’Œæé«˜å‡†ç¡®æ€§ã€‚ å½“æˆ‘ä»¬å®Œæˆæ‰€æœ‰çš„è¿­ä»£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œæµ‹è¯•ã€‚

æ¸…æ¥šäº†å—ï¼Ÿå‡†å¤‡å¼€å§‹äº†ï¼

```py
import tensorflow as tf
from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets("/tmp/data/", one_hot = True)
```

æˆ‘ä»¬å¯¼å…¥ TensorFlow å’Œæˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ ·æœ¬æ•°æ®ã€‚ è¯·æ³¨æ„`one_hot`å‚æ•°ã€‚ è¿™ä¸ªæœ¯è¯­æ¥è‡ªåªæœ‰ä¸€ä¸ªå…ƒç´ çš„ç‚¹å­ï¼Œåœ¨å…¶ä½™å…ƒç´ å½“ä¸­ï¼Œå­—é¢ä¸Šæ˜¯â€œçƒ­â€çš„ï¼Œæˆ–è€…å¼€å¯çš„ã€‚ è¿™å¯¹äºæˆ‘ä»¬è¿™é‡Œçš„å¤šç±»åˆ†ç±»ä»»åŠ¡æ˜¯æœ‰ç”¨çš„ï¼ˆ0 ~ 9ï¼‰ã€‚ å› æ­¤ï¼Œä¸æ˜¯ç®€å•çš„ 0 æˆ–è€… 1ï¼Œæˆ‘ä»¬æ‹¥æœ‰ï¼š

```
0 = [1,0,0,0,0,0,0,0,0]
1 = [0,1,0,0,0,0,0,0,0]
2 = [0,0,1,0,0,0,0,0,0]
3 = [0,0,0,1,0,0,0,0,0]
...
```

å¥½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰äº†æ•°æ®ã€‚ æˆ‘é€‰æ‹©ä½¿ç”¨ MNIST æ•°æ®é›†ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåˆé€‚çš„èµ·å§‹æ•°æ®é›†ï¼Œå®é™…ä¸Šï¼Œæ”¶é›†åŸå§‹æ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸ºå¯ä»¥ä½¿ç”¨çš„ä¸œè¥¿ï¼Œæ¯”åˆ›å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æœ¬èº«éœ€è¦æ›´å¤šçš„æ—¶é—´ï¼Œæˆ‘è®¤ä¸ºè¿™é‡Œå¤§å¤šæ•°äººéƒ½æƒ³å­¦ä¹  ç¥ç»ç½‘ç»œï¼Œè€Œä¸æ˜¯ç½‘é¡µæŠ“å–å’Œæ­£åˆ™è¡¨è¾¾å¼ã€‚

ç°åœ¨æˆ‘ä»¬è¦å¼€å§‹æ„å»ºæ¨¡å‹ï¼š

```py
n_nodes_hl1 = 500
n_nodes_hl2 = 500
n_nodes_hl3 = 500
n_classes = 10
batch_size = 100
```

æˆ‘ä»¬é¦–å…ˆæŒ‡å®šæ¯ä¸ªéšè—å±‚å°†æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†æœ‰å¤šå°‘ä»½é¢é‡Œï¼Œä»¥åŠæˆ‘ä»¬çš„æ‰¹é‡å¤§å°ã€‚ è™½ç„¶ä½ ç†è®ºä¸Š**å¯ä»¥**ä¸€æ¬¡è®­ç»ƒæ•´ä¸ªç½‘ç»œï¼Œè¿™æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ ä½ ä»¬ä¸­çš„è®¸å¤šäººå¯èƒ½æœ‰å¯ä»¥å®Œå…¨å¤„ç† MNIST æ•°æ®é›†çš„è®¡ç®—æœºï¼Œä½†æ˜¯å¤§å¤šæ•°äººéƒ½æ²¡æœ‰æˆ–å¯ä»¥è®¿é—®è¿™ç§è®¡ç®—æœºï¼Œå®ƒä»¬å¯ä»¥ä¸€æ¬¡å®Œæˆå®é™…å¤§å°çš„æ•°æ®é›†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è¿›è¡Œæ‰¹é‡ä¼˜åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œ 100 ä¸ªæ‰¹æ¬¡ã€‚

```py
x = tf.placeholder('float', [None, 784])
y = tf.placeholder('float')
```

è¿™äº›æ˜¯æˆ‘ä»¬å›¾ä¸­æŸäº›å€¼çš„å ä½ç¬¦ã€‚ å›æƒ³ä¸€ä¸‹ï¼Œä½ åªéœ€åœ¨ TensorFlow å›¾ä¸­æ„å»ºæ¨¡å‹å³å¯ã€‚ åœ¨è¿™é‡Œï¼ŒTensorFlow æ“çºµä¸€åˆ‡ï¼Œè€Œä½ ä¸ä¼šã€‚ ä¸€æ—¦å®Œæˆï¼Œè¿™å°†æ›´åŠ æ˜æ˜¾ï¼Œä½ å°è¯•å¯»æ‰¾åœ¨å“ªé‡Œä¿®æ”¹é‡é‡ï¼ è¯·æ³¨æ„ï¼Œæˆ‘å·²ç»ä½¿ç”¨`[None,784]`ä½œä¸ºç¬¬ä¸€ä¸ªå ä½ç¬¦ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç„¶è€Œè¿™æ ·æ˜¾å¼æŒ‡å®šéå¸¸æœ‰ç”¨ã€‚ å¦‚æœä½ ä¸æ˜¾å¼æŒ‡å®šï¼ŒTensorFlow ä¼šåœ¨é‚£é‡Œå¡«å……ä»»ä½•ä¸œè¥¿ã€‚ å¦‚æœä½ çš„å½¢çŠ¶æ˜¯æ˜¾å¼çš„ï¼Œå¹¶ä¸”ä¸€äº›ä¸åŒå½¢çŠ¶çš„ä¸œè¥¿å°è¯•æ”¾è¿›è¿™ä¸ªå˜é‡çš„åœ°æ–¹ï¼ŒTensorFlow å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

æˆ‘ä»¬ç°åœ¨å®Œæˆäº†æˆ‘ä»¬çš„å¸¸é‡ä»¥åŠå…¶å®å€¼ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å®é™…æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹äº†ï¼š

```py
def neural_network_model(data):
    hidden_1_layer = {'weights':tf.Variable(tf.random_normal([784, n_nodes_hl1])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl1]))}

    hidden_2_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl1, n_nodes_hl2])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl2]))}

    hidden_3_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl2, n_nodes_hl3])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl3]))}

    output_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl3, n_classes])),
                    'biases':tf.Variable(tf.random_normal([n_classes]))}
```


è¿™é‡Œï¼Œæˆ‘ä»¬å¼€å§‹å®šä¹‰æˆ‘ä»¬çš„æƒé‡å’Œæˆ‘ä»¬çš„...ç­‰ç­‰ï¼Œè¿™äº›åå·®æ˜¯ä»€ä¹ˆï¼Ÿ åå·®æ˜¯åœ¨é€šè¿‡æ¿€æ´»å‡½æ•°ä¹‹å‰ï¼Œä¸æˆ‘ä»¬çš„ç›¸åŠ çš„å€¼ï¼Œä¸è¦ä¸åå·®èŠ‚ç‚¹æ··æ·†ï¼Œåå·®èŠ‚ç‚¹åªæ˜¯ä¸€ä¸ªæ€»æ˜¯å­˜åœ¨çš„èŠ‚ç‚¹ã€‚ è¿™é‡Œçš„åå·®çš„ç›®çš„ä¸»è¦æ˜¯ï¼Œå¤„ç†æ‰€æœ‰ç¥ç»å…ƒç”Ÿæˆ 0 çš„æƒ…å†µã€‚ åå·®ä½¿å¾—ç¥ç»å…ƒä»ç„¶èƒ½å¤Ÿä»è¯¥å±‚ä¸­è§¦å‘ã€‚ åå·®ä¸æƒé‡ä¸€æ ·ç‹¬ç‰¹ï¼Œä¹Ÿéœ€è¦ä¼˜åŒ–ã€‚

æˆ‘ä»¬è¿„ä»Šæ‰€åšçš„ä¸€åˆ‡éƒ½æ˜¯ä¸ºæˆ‘ä»¬çš„æƒé‡å’Œåå·®åˆ›å»ºä¸€ä¸ªèµ·å§‹å®šä¹‰ã€‚ å¯¹äºå±‚çš„çŸ©é˜µçš„åº”æœ‰å½¢çŠ¶ï¼Œè¿™äº›å®šä¹‰åªæ˜¯éšæœºå€¼ï¼ˆè¿™æ˜¯`tf.random_normal`ä¸ºæˆ‘ä»¬åšçš„äº‹æƒ…ï¼Œå®ƒä¸ºæˆ‘ä»¬è¾“å‡ºç¬¦åˆå½¢çŠ¶çš„éšæœºå€¼ï¼‰ã€‚ è¿˜æ²¡æœ‰å‘ç”Ÿä»»ä½•äº‹æƒ…ï¼Œæ²¡æœ‰å‘ç”ŸæµåŠ¨ï¼ˆå‰é¦ˆï¼‰ã€‚æˆ‘ä»¬å¼€å§‹æµç¨‹ï¼š

```py
    l1 = tf.add(tf.matmul(data,hidden_1_layer['weights']), hidden_1_layer['biases'])
    l1 = tf.nn.relu(l1)

    l2 = tf.add(tf.matmul(l1,hidden_2_layer['weights']), hidden_2_layer['biases'])
    l2 = tf.nn.relu(l2)

    l3 = tf.add(tf.matmul(l2,hidden_3_layer['weights']), hidden_3_layer['biases'])
    l3 = tf.nn.relu(l3)

    output = tf.matmul(l3,output_layer['weights']) + output_layer['biases']

    return output
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å€¼ä¼ å…¥ç¬¬ä¸€å±‚ã€‚ è¿™äº›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒä»¬æ˜¯åŸå§‹è¾“å…¥æ•°æ®ä¹˜ä»¥å…¶å”¯ä¸€æƒé‡ï¼ˆä»éšæœºå¼€å§‹ï¼Œä½†å°†è¢«ä¼˜åŒ–ï¼‰ï¼š`tf.matmul(l1,hidden_2_layer['weights'])`ã€‚ ç„¶åï¼Œæˆ‘ä»¬æ·»åŠ äº†`tf.add`çš„åå·®ã€‚ æˆ‘ä»¬å¯¹æ¯ä¸ªéšè—å±‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æˆ‘ä»¬çš„è¾“å‡ºï¼Œæˆ‘ä»¬çš„æœ€ç»ˆå€¼ä»ç„¶æ˜¯è¾“å…¥å’Œæƒé‡çš„ä¹˜ç§¯ï¼ŒåŠ ä¸Šè¾“å‡ºå±‚çš„åå·®å€¼ã€‚

å®Œæˆåï¼Œæˆ‘ä»¬åªéœ€è¿”å›è¯¥è¾“å‡ºå±‚ã€‚ æ‰€ä»¥ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»æ„å»ºäº†ç½‘ç»œï¼Œå‡ ä¹å®Œæˆäº†æ•´ä¸ªè®¡ç®—å›¾å½¢ã€‚ åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ TensorFlow å®é™…è¿è¡Œå¹¶è®­ç»ƒç½‘ç»œã€‚
# µÚËÄÊ®ÆßÕÂ Éî¶ÈÑ§Ï°ºÍ TensorFlow - Éñ¾­ÍøÂçÈçºÎÔËĞĞ

> Ô­ÎÄ£º[Deep Learning with TensorFlow - Creating the Neural Network Model](https://pythonprogramming.net/tensorflow-neural-network-session-machine-learning-tutorial/)

> ÒëÕß£º[·ÉÁú](https://github.com/wizardforcel)

> Ğ­Òé£º[CC BY-NC-SA 4.0](http://creativecommons.org/licenses/by-nc-sa/4.0/)

»¶Ó­ÔÄ¶ÁÉî¶ÈÑ§Ï°ÓëÉñ¾­ÍøÂçºÍ TensorFlow µÄµÚËÄ²¿·Ö£¬ÒÔ¼°»úÆ÷Ñ§Ï°½Ì³ÌÏµÁĞµÄµÚ 46 ²¿·Ö¡£ ÔÚ±¾½Ì³ÌÖĞ£¬ÎÒÃÇ½«ÔÚ TensorFlow ÖĞ±àĞ´»á»°ÆÚ¼ä·¢ÉúµÄ´úÂë¡£

ÕâÀïµÄ´úÂëÒÑ¾­¸üĞÂ£¬ÒÔ±ãÖ§³ÖTensorFlow 1.0£¬µ«ÊÓÆµÓĞÁ½ĞĞĞèÒªÉÔÎ¢¸üĞÂ¡£

ÔÚÇ°ÃæµÄ½Ì³ÌÖĞ£¬ÎÒÃÇ¹¹½¨ÁËÈË¹¤Éñ¾­ÍøÂçµÄÄ£ĞÍ£¬²¢ÓÃ TensorFlow ½¨Á¢ÁË¼ÆËãÍ¼±í¡£ ÏÖÔÚÎÒÃÇĞèÒªÊµ¼Ê½¨Á¢ÑµÁ·¹ı³Ì£¬Õâ½«ÔÚ TensorFlow »á»°ÖĞÔËĞĞ¡£ ¼ÌĞø´¦ÀíÎÒÃÇµÄ´úÂë£º

```py
def train_neural_network(x):
    prediction = neural_network_model(x)
    cost = tf.reduce_mean( tf.nn.softmax_cross_entropy_with_logits(logits=prediction, labels=y) )
```

ÔÚĞÂµÄº¯Êı`train_neural_network`ÏÂ£¬ÎÒÃÇ´«ÈëÊı¾İ¡£ È»ºó£¬ÎÒÃÇÍ¨¹ıÎÒÃÇµÄ`neural_network_model`²úÉúÒ»¸ö»ùÓÚ¸ÃÊı¾İÊä³öµÄÔ¤²â¡£ ½ÓÏÂÀ´£¬ÎÒÃÇ´´½¨Ò»¸ö¿ªÏú±äÁ¿£¬ºâÁ¿ÎÒÃÇÓĞ¶àÉÙ´íÎó£¬¶øÇÒÎÒÃÇÏ£ÍûÍ¨¹ı²Ù×İÎÒÃÇµÄÈ¨ÖØÀ´×îĞ¡»¯Õâ¸ö±äÁ¿¡£ ¿ªÏúº¯ÊıÊÇËğÊ§º¯ÊıµÄ´úÃû´Ê¡£ ÎªÁËÓÅ»¯ÎÒÃÇµÄ³É±¾£¬ÎÒÃÇ½«Ê¹ÓÃ`AdamOptimizer`£¬ËüÊÇÒ»¸öÁ÷ĞĞµÄÓÅ»¯Æ÷£¬ÒÔ¼°ÆäËûÀàËÆµÄËæ»úÌİ¶ÈÏÂ½µºÍ`AdaGrad`¡£

```py
    optimizer = tf.train.AdamOptimizer().minimize(cost)
```

ÔÚ`AdamOptimizer()`ÖĞ£¬Äú¿ÉÒÔÑ¡Ôñ½«`learning_rate`Ö¸¶¨Îª²ÎÊı¡£Ä¬ÈÏÖµÎª 0.001£¬ÕâÔÚ´ó¶àÊıÇé¿öÏÂ¶¼²»´í¡£ ÏÖÔÚÎÒÃÇ¶¨ÒåÁËÕâĞ©¶«Î÷£¬ÎÒÃÇ½«Æô¶¯»á»°¡£

```py
    hm_epochs = 10
    with tf.Session() as sess:
        sess.run(tf.global_variables_initializer())
```

Ê×ÏÈ£¬ÎÒÃÇÓĞÒ»¸ö¼òµ¥µÄ`hm_epochs`±äÁ¿£¬Ëü½«È·¶¨ÓĞ¶àÉÙ¸öµü´ú£¨Ç°À¡ºÍºóÍËÑ­»·£©¡£ ½ÓÏÂÀ´£¬ÎÒÃÇÊ¹ÓÃÉÏÒ»¸ö½Ì³ÌÖĞÌÖÂÛµÄ»á»°¿ªÆôºÍ¹Ø±ÕµÄÓï·¨¡£ Ê×ÏÈ£¬ÎÒÃÇ³õÊ¼»¯ËùÓĞµÄ±äÁ¿¡£ÕâÊÇÖ÷Òª²½Öè£º

```py
        for epoch in range(hm_epochs):
            epoch_loss = 0
            for _ in range(int(mnist.train.num_examples/batch_size)):
                epoch_x, epoch_y = mnist.train.next_batch(batch_size)
                _, c = sess.run([optimizer, cost], feed_dict={x: epoch_x, y: epoch_y})
                epoch_loss += c

            print('Epoch', epoch, 'completed out of',hm_epochs,'loss:',epoch_loss)
```

¶ÔÓÚÃ¿¸öµü´ú£¬¶ÔÓÚÎÒÃÇµÄÊı¾İÖĞµÄÃ¿¸öÅú´Î£¬ÎÒÃÇ½«Õë¶ÔÎÒÃÇÊı¾İÅú´ÎÔËĞĞÓÅ»¯Æ÷ºÍ¿ªÏú¡£ ÎªÁË¸ú×ÙÎÒÃÇÃ¿Ò»²½µÄËğÊ§»ò¿ªÏú£¬ÎÒÃÇÒªÌí¼ÓÃ¿¸öµü´úµÄ×Ü¿ªÏú¡£ ¶ÔÓÚÃ¿¸öµü´ú£¬ÎÒÃÇÊä³öËğÊ§£¬Ã¿´Î¶¼Ó¦¸ÃÏÂ½µ¡£ Õâ¿ÉÒÔÓÃÓÚ¸ú×Ù£¬ËùÒÔËæ×ÅÊ±¼äµÄÍÆÒÆ£¬Äã¿ÉÒÔ¿´µ½ÊÕÒæµİ¼õ¡£ Ç°¼¸¸öµü´úÓ¦¸ÃÓĞºÜ´óµÄ¸Ä½ø£¬µ«ÊÇÔÚ´óÔ¼ 10 »ò 20 Ö®¼ä£¬Äã»á¿´µ½ºÜĞ¡µÄ±ä»¯£¬»òÕß¿ÉÄÜ»á±äµÃ¸üÔã¡£

ÏÖÔÚ£¬ÔÚÑ­»·Ö®Íâ£º

```py
        correct = tf.equal(tf.argmax(prediction, 1), tf.argmax(y, 1))
```

Õâ»á¸æËßÎÒÃÇ£¬ÎÒÃÇ×öÁË¶àÉÙ¸öÔ¤²â£¬ËüÍêÃÀÆ¥ÅäËüÃÇµÄ±êÇ©¡£

```py
        accuracy = tf.reduce_mean(tf.cast(correct, 'float'))
        print('Accuracy:',accuracy.eval({x:mnist.test.images, y:mnist.test.labels}))
```

ÏÖÔÚÎÒÃÇÓµÓĞÁË²âÊÔ¼¯ÉÏµÄ×îÖÕ×¼È·ÂÊ¡£ÏÖÔÚÎÒÃÇĞèÒª£º

```py
train_neural_network(x)
```

ÔÚ 10 µ½ 20 ¸öµü´úµÄÄ³¸öµØ·½Ó¦¸ÃÓĞ 95% µÄ×¼È·¶È¡£ 95% µÄ×¼È·¶È£¬ÌıÆğÀ´²»´í£¬µ«±ÈÆğ¸üÖ÷Á÷µÄ·½·¨£¬Êµ¼ÊÉÏ±»ÈÏÎª·Ç³£Ôã¸â¡£ ÎÒÊµ¼ÊÉÏÈÏÎª 95% µÄ×¼È·ĞÔ£¬Õâ¸öÄ£ĞÍÊÇÃ»ÓĞÊ²Ã´ÒâÍâµÄ¡£ ¿¼ÂÇµ½ÎÒÃÇ¸øÍøÂçµÄÎ¨Ò»ĞÅÏ¢ÊÇÏñËØÖµ£¬¾ÍÊÇÕâÑù¡£ ÎÒÃÇÃ»ÓĞ¸æËßËüÈçºÎÑ°ÕÒÄ£Ê½£¬»òÕßËµÈçºÎ´Ó 9 ÖĞµÃµ½Ò»¸ö4 £¬»òÕß´Ó 8 ÖĞµÃµ½Ò»¸ö 1¡£ÍøÂçÖ»ÊÇÓÃÒ»¸öÄÚÔÚµÄÄ£ĞÍÀ´¼ÆËã³öÀ´£¬´¿´âÊÇ»ùÓÚÏñËØÖµÀ´¿ªÊ¼£¬²¢ÇÒ´ïµ½ÁË 95% ×¼È·ĞÔ¡£ ¶ÔÎÒÀ´ËµÕâÊÇ¾ªÈËµÄ£¬ËäÈ»×îÏÈ½øµÄ¼¼Êõ³¬¹ı 99%¡£

Ä¿Ç°ÎªÖ¹µÄÍêÕû´úÂë£º

```py
import tensorflow as tf
from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets("/tmp/data/", one_hot = True)

n_nodes_hl1 = 500
n_nodes_hl2 = 500
n_nodes_hl3 = 500

n_classes = 10
batch_size = 100

x = tf.placeholder('float', [None, 784])
y = tf.placeholder('float')

def neural_network_model(data):
    hidden_1_layer = {'weights':tf.Variable(tf.random_normal([784, n_nodes_hl1])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl1]))}

    hidden_2_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl1, n_nodes_hl2])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl2]))}

    hidden_3_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl2, n_nodes_hl3])),
                      'biases':tf.Variable(tf.random_normal([n_nodes_hl3]))}

    output_layer = {'weights':tf.Variable(tf.random_normal([n_nodes_hl3, n_classes])),
                    'biases':tf.Variable(tf.random_normal([n_classes])),}


    l1 = tf.add(tf.matmul(data,hidden_1_layer['weights']), hidden_1_layer['biases'])
    l1 = tf.nn.relu(l1)

    l2 = tf.add(tf.matmul(l1,hidden_2_layer['weights']), hidden_2_layer['biases'])
    l2 = tf.nn.relu(l2)

    l3 = tf.add(tf.matmul(l2,hidden_3_layer['weights']), hidden_3_layer['biases'])
    l3 = tf.nn.relu(l3)

    output = tf.matmul(l3,output_layer['weights']) + output_layer['biases']

    return output

def train_neural_network(x):
    prediction = neural_network_model(x)
    # OLD VERSION:
    #cost = tf.reduce_mean( tf.nn.softmax_cross_entropy_with_logits(prediction,y) )
    # NEW:
    cost = tf.reduce_mean( tf.nn.softmax_cross_entropy_with_logits(logits=prediction, labels=y) )
    optimizer = tf.train.AdamOptimizer().minimize(cost)
    
    hm_epochs = 10
    with tf.Session() as sess:
        # OLD:
        #sess.run(tf.initialize_all_variables())
        # NEW:
        sess.run(tf.global_variables_initializer())

        for epoch in range(hm_epochs):
            epoch_loss = 0
            for _ in range(int(mnist.train.num_examples/batch_size)):
                epoch_x, epoch_y = mnist.train.next_batch(batch_size)
                _, c = sess.run([optimizer, cost], feed_dict={x: epoch_x, y: epoch_y})
                epoch_loss += c

            print('Epoch', epoch, 'completed out of',hm_epochs,'loss:',epoch_loss)

        correct = tf.equal(tf.argmax(prediction, 1), tf.argmax(y, 1))

        accuracy = tf.reduce_mean(tf.cast(correct, 'float'))
        print('Accuracy:',accuracy.eval({x:mnist.test.images, y:mnist.test.labels}))

train_neural_network(x)
```

ÏÂÒ»Æª½Ì³ÌÖĞ£¬ÎÒÃÇ³¢ÊÔÊ¹ÓÃÕâ¸ö×¼È·µÄÄ£ĞÍ£¬²¢½«ÆäÓ¦ÓÃµ½Ò»¸öĞÂµÄÊı¾İ¼¯£¬Õâ¶ÔÎÒÃÇÀ´Ëµ²¢Ã»ÓĞ×¼±¸ºÃ¡£
